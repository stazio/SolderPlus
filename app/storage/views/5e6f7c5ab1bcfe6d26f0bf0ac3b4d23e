<?php $__env->startSection('title'); ?>
    <title><?php echo $modpack->name; ?> - TechnicSolder</title>
<?php $__env->stopSection(); ?>
<?php $__env->startSection('content'); ?>
<h1>Build Management - <?php echo $modpack->name; ?></h1>
<hr>
<div class="panel panel-default">
	<div class="panel-heading">
		<div class="pull-right">
			<a class="btn btn-primary btn-xs" href="<?php echo URL::to('modpack/add-build/'.$modpack->id); ?>">Create New Build</a>
			<a class="btn btn-warning btn-xs" href="<?php echo URL::to('modpack/edit/'.$modpack->id); ?>">Edit Modpack</a>
		</div>
	Build Management: <?php echo $modpack->name; ?>

	</div>
	<div class="panel-body">
		<?php if(Session::has('success')): ?>
		<div class="alert alert-success">
			<?php echo Session::get('success'); ?>

		</div>
		<?php endif; ?>
		<div class="table-responsive">
		<table class="table table-striped table-bordered table-hover" id="dataTables">
			<thead>
				<tr>
					<th>#</th>
					<th>Build Number</th>
					<th>MC Version</th>
					<th>Mod Count</th>
					<th>Rec</th>
					<th>Latest</th>
					<th>Published</th>
					<th>Private</th>
					<th>Created on</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
			<?php foreach($modpack->builds as $build): ?>
				<tr>
					<td><?php echo $build->id; ?></td>
					<td><?php echo $build->version; ?></td>
					<td><?php echo $build->minecraft; ?></td>
					<td><?php echo count($build->modversions); ?></td>
					<td><input type="radio" name="recommended" value="<?php echo $build->version; ?>"<?php echo $checked = ($modpack->recommended == $build->version ? " checked" : ""); ?>></td>
					<td><input type="radio" name="latest" value="<?php echo $build->version; ?>"<?php echo $checked = ($modpack->latest == $build->version ? " checked" : ""); ?>></td>
					<td><input type="checkbox" name="published" value="1" class="published" rel="<?php echo $build->id; ?>"<?php echo ($build->is_published ? " checked" : ""); ?>></td>
					<td><input type="checkbox" name="private" value="1" class="private" rel="<?php echo $build->id; ?>"<?php echo ($build->private ? " checked" : ""); ?>></td>
					<td><?php echo $build->created_at; ?></td>
					<td><?php echo HTML::link('modpack/build/'.$build->id, "Manage",'class="btn btn-xs btn-primary"'); ?>

						<?php echo HTML::link('modpack/build/'.$build->id.'?action=edit', "Settings",'class="btn btn-xs btn-warning"'); ?>

						<?php echo HTML::link('modpack/build/'.$build->id.'?action=delete', "Delete",'class="btn btn-xs btn-danger"'); ?>

						<?php echo HTML::link("modpack/add-build/$modpack->id?action=clone&build_id=$build->id", "Clone",'class="btn btn-xs btn-success"'); ?>

					</td>
				</tr>
			<?php endforeach; ?>
			</tbody>
		</table>
		</div>
	</div>
</div>
<?php $__env->stopSection(); ?>
<?php $__env->startSection('bottom'); ?>
<script type="text/javascript">

$("input[name=recommended]").change(function() {
	$.ajax({
		type: "GET",
		url: "<?php echo URL::to('modpack/modify/recommended?modpack='.$modpack->id); ?>&recommended=" + encodeURIComponent($(this).val()),
		success: function (data) {
			$.jGrowl(data.success, { group: 'alert-success' });
		}
	});
});

$("input[name=latest]").change(function() {
	$.ajax({
		type: "GET",
		url: "<?php echo URL::to('modpack/modify/latest?modpack='.$modpack->id); ?>&latest=" + encodeURIComponent($(this).val()),
		success: function (data) {
			$.jGrowl(data.success, { group: 'alert-success' });
		}
	});
});

$(".published").change(function() {
	var checked = 0;
	if (this.checked)
		checked = 1;
	$.ajax({
		type: "GET",
		url: "<?php echo URL::to('modpack/modify/published'); ?>?build=" + $(this).attr("rel") + "&published=" + checked,
		success: function (data) {
			$.jGrowl(data.success, { group: 'alert-success' });
		}
	})
});

$(".private").change(function() {
	var checked = 0;
	if (this.checked)
		checked = 1;
	$.ajax({
		type: "GET",
		url: "<?php echo URL::to('modpack/modify/private'); ?>?build=" + $(this).attr("rel") + "&private=" + checked,
		success: function (data) {
			$.jGrowl(data.success, { group: 'alert-success' });
		}
	})
});

$(document).ready(function() {
    $('#dataTables').dataTable({
    	"order": [[ 1, "desc" ]]
    });
});

</script>
<?php $__env->stopSection(); ?>

<?php echo $__env->make('layouts/master', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>